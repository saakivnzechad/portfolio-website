var T=Object.defineProperty;var m=(n,e,r)=>e in n?T(n,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[e]=r;var g=(n,e,r)=>m(n,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(t){if(t.ep)return;t.ep=!0;const a=r(t);fetch(t.href,a)}})();class p{constructor(e={}){g(this,"config");g(this,"rootElement");g(this,"themeToggleButton");g(this,"themeToggleButtonTextSpan");g(this,"currentTheme");this.config={localStorageKey:e.localStorageKey??"theme",themeToggleButtonSelector:e.themeToggleButtonSelector??"",themeToggleButtonTextSelector:e.themeToggleButtonTextSelector??"",rootElement:e.rootElement},this.rootElement=this.config.rootElement??document.documentElement,this.themeToggleButton=this.config.themeToggleButtonSelector?document.querySelector(this.config.themeToggleButtonSelector):null,this.themeToggleButtonTextSpan=this.themeToggleButton&&this.config.themeToggleButtonTextSelector?this.themeToggleButton.querySelector(this.config.themeToggleButtonTextSelector):null,this.currentTheme="light"}getSavedTheme(){return localStorage.getItem(this.config.localStorageKey)}saveTheme(e){localStorage.setItem(this.config.localStorageKey,e)}getSystemTheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}applyTheme(e){this.currentTheme!==e&&(this.currentTheme=e,this.rootElement.dataset.theme=e==="dark"?"dark":"",this.themeToggleButtonTextSpan&&(this.themeToggleButtonTextSpan.textContent=e))}initialize(){this.applyTheme(this.getSavedTheme()??this.getSystemTheme()),this.themeToggleButton&&this.themeToggleButton.addEventListener("click",()=>this.toggle())}toggle(){this.setTheme(this.currentTheme==="light"?"dark":"light")}setTheme(e){this.saveTheme(e),this.applyTheme(e)}getTheme(){return this.currentTheme}}const i={storageKey:"appLanguage",defaultLanguage:"en",supportedLanguages:["en","ru"]};let h=null;const d=new Set;function S(){const n=localStorage.getItem(i.storageKey);if(n&&i.supportedLanguages.includes(n))return n;const e=navigator.language.split("-")[0];return i.supportedLanguages.includes(e)?e:i.defaultLanguage}function c(n){if(!i.supportedLanguages.includes(n)){console.warn(`Unsupported language: ${n}. Must be one of ${i.supportedLanguages.join(", ")}.`);return}h!==n&&(h=n,localStorage.setItem(i.storageKey,n),document.documentElement.lang=n,d.forEach(e=>e(n)))}function y(){return h||c(S()),h}function L(n){return d.add(n),()=>d.delete(n)}function B(){return i.supportedLanguages}class x{constructor(e={}){g(this,"config");g(this,"rootElement");g(this,"languageToggleButton");g(this,"languageToggleButtonTextSpan");g(this,"contentContainer");g(this,"translationsCache",new Map);g(this,"currentLanguage");this.config={localesPath:e.localesPath??"/locales",defaultLanguage:e.defaultLanguage??"en",languageToggleButtonSelector:e.languageToggleButtonSelector??null,languageToggleButtonTextSelector:e.languageToggleButtonTextSelector??null,contentContainerSelector:e.contentContainerSelector??"body",fadeDuration:e.fadeDuration??200},this.rootElement=document.documentElement,this.languageToggleButton=this.config.languageToggleButtonSelector?document.querySelector(this.config.languageToggleButtonSelector):null,this.languageToggleButtonTextSpan=this.languageToggleButton&&this.config.languageToggleButtonTextSelector?this.languageToggleButton.querySelector(this.config.languageToggleButtonTextSelector):null,this.contentContainer=this.config.contentContainerSelector?document.querySelector(this.config.contentContainerSelector):null,this.currentLanguage=y()}async loadTranslations(e){if(this.translationsCache.has(e))return this.translationsCache.get(e);try{const r=await fetch(`${this.config.localesPath}/${e}.json`);if(!r.ok)throw new Error(`Failed to load translations for ${e}`);const o=await r.json();return this.translationsCache.set(e,o),o}catch(r){return console.error("Error loading translations:",r),e!==this.config.defaultLanguage?this.loadTranslations(this.config.defaultLanguage):{}}}getNestedTranslation(e,r){const o=e.split(".");let t=r;for(const a of o)if(typeof t=="object"&&a in t)t=t[a];else return`[${e}]`;return typeof t=="string"?t:`[INVALID_TYPE: ${e}]`}async applyTranslations(){this.contentContainer&&(this.contentContainer.style.transition=`opacity ${this.config.fadeDuration}ms ease-in-out`,this.contentContainer.style.opacity="0");const e=await this.loadTranslations(this.currentLanguage);this.rootElement.lang=this.currentLanguage,document.querySelectorAll("[data-i18n], [data-i18n-attr], title[data-i18n]").forEach(o=>{var s;const t=o.getAttribute("data-i18n");if(t){const l=this.getNestedTranslation(t,e);if(l.includes("<br>")||o.tagName==="TITLE")o.innerHTML=l;else if(o.children.length>0){for(const u of Array.from(o.childNodes))if(u.nodeType===3&&((s=u.textContent)==null?void 0:s.trim())!==""){u.textContent=l;break}}else o.textContent=l}const a=o.getAttribute("data-i18n-attr");a&&a.split(";").forEach(l=>{const[u,f]=l.split(":");u&&f&&o.setAttribute(u,this.getNestedTranslation(f,e))})}),this.languageToggleButtonTextSpan&&(this.languageToggleButtonTextSpan.textContent=this.currentLanguage),this.contentContainer&&requestAnimationFrame(()=>{this.contentContainer.style.opacity="1",setTimeout(()=>{this.contentContainer&&(this.contentContainer.style.transition="")},this.config.fadeDuration)})}async initialize(){c(this.currentLanguage),await this.applyTranslations(),L(async e=>{this.currentLanguage=e,await this.applyTranslations()}),this.languageToggleButton&&this.languageToggleButton.addEventListener("click",()=>this.toggleLanguage())}toggleLanguage(){const e=B(),o=(e.indexOf(this.currentLanguage)+1)%e.length;c(e[o])}setLanguage(e){c(e)}getLanguage(){return this.currentLanguage}}document.addEventListener("DOMContentLoaded",async()=>{new p({localStorageKey:"portfolio-theme",themeToggleButtonSelector:"#theme-toggle",themeToggleButtonTextSelector:"span:nth-of-type(2)"}).initialize(),await new x({localesPath:"/locales",defaultLanguage:"en",languageToggleButtonSelector:"#lang-toggle",languageToggleButtonTextSelector:"span:nth-of-type(2)",contentContainerSelector:"body"}).initialize()});
